<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="jp.kouto.fuyuki.akiba.todo_application.mapper.TodoListMapper">
    <resultMap id="todoListResultMap" type="jp.kouto.fuyuki.akiba.todo_application.dto.TodoListDto">
        <id property="id" column="id" />
        <result property="userId" column="user_id" />
        <result property="content" column="content" />
        <result property="dueDate" column="due_date" />
        <result property="status" column="status" />
        <result property="createDate" column="create_date" />
        <result property="updateDate" column="update_date" />
        <result property="deletedDate" column="deleted_date" />
    </resultMap>
        <!-- リスト取得 -->
    <select id="getTodoListByUserId" parameterType="hashmap" resultMap="todoListResultMap">
        SELECT id, user_id, content, due_date, status, create_date, update_date, deleted_date
        FROM todo_lists
        WHERE user_id = #{userId}
        ORDER BY due_date ASC, create_date ASC
    </select>

    <!-- 新規リスト挿入 -->
    <insert id="insertTask" useGeneratedKeys="true" keyProperty="id">
        INSERT INTO todo_lists (user_id, content, due_date, status, create_date, update_date)
        VALUES (#{userId}, #{content}, #{dueDate}, #{status}, NOW(), NOW())
    </insert>

</mapper>